
import netutils

def dbscan(start, end, nh):
    iprange = []
    if nh is None:
        iprange = netutils.ips_in_range(start, end)
    else:
        iprange = netutils.ips_starting_at(start, int(nh))
    allDat = []
    for ip in iprange:
        print("Scanning %s..." % (ip,))
        resDat = netutils.db_scan(ip)
        #print("Result (%s): \t %s" % (ip, str(resDat)))
        newDat = [(ip, x[0], x[2], x[1]) for x in resDat]
        allDat.extend(newDat)
    #print("Result:\n%s" % (repr(allDat)))
    openDat = [x for x in allDat if (x[3] == 'open' and (not x[2].endswith("?")))]
    print("Result:\n%s" % (repr(openDat)))

def brutedns(start):
    dat = netutils.brute_dns(start)
    print("Result:\n%s" % (repr(dat)))
