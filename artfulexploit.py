#!/usr/bin/python3

import sys, argparse

from tasks import *

def main(argv):
    parser = argparse.ArgumentParser(description="Artful Exploit v0.1")
    parser.add_argument("--task", help="Task at hand (one of: dbscan, heartbleed)")
    parser.add_argument("--target", help="Pentesting target host")
    parser.add_argument("--end", help="Last host in IP range (if specifying a range)")
    parser.add_argument("--numhosts", help="Number of hosts to test (if specifying a range)")
    args = parser.parse_args()
    print("Task: " + str(args.task))
    task = str(args.task).lower()
    if task == "dbscan":
        dbscan(args.target, args.end, args.numhosts)
    elif task == "brutedns":
        brutedns(args.target)

if __name__ == "__main__":
    main(sys.argv[1:])
